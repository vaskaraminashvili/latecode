document.addEventListener('DOMContentLoaded', function() {
    initGlossaryFilter();
});

// Filter Glossary items
function initGlossaryFilter() {
    // Filter using search box
    const glossarySearchInput = document.getElementById('glossarySearchInput');
    if (glossarySearchInput) {
        glossarySearchInput.addEventListener('keyup', function() {
            const inputValue = this.value.toUpperCase();

            // Hide all the results & Cards
            document.querySelectorAll('.glossary__results__row').forEach(row => {
                row.classList.add('inactive');
            });
            document.querySelectorAll('.glossary__results__item').forEach(item => {
                item.style.display = 'none';
            });

            document.querySelectorAll('.glossary__results__row').forEach(row => {
                document.querySelectorAll('.glossary__results__item').forEach(item => {
                    const itemText = item.getAttribute('data-item').toUpperCase();

                    if (itemText.includes(inputValue)) {
                        row.classList.remove('inactive');
                        item.style.display = '';
                    }
                });
            });
        });
    }

    // Filter using navigation
    document.querySelectorAll('.glossary__nav a').forEach(navLink => {
        navLink.addEventListener('click', function(e) {
            const nav = this.getAttribute('data-nav');
            if (nav == 'all'){
                document.querySelectorAll('.glossary__results__row').forEach(row => {
                    row.classList.remove('inactive');
                });
            }else{
                // Remove & Add active class
                document.querySelectorAll('.glossary__nav__item').forEach(item => {
                    item.classList.remove('active');
                });
                this.parentElement.classList.toggle('active');

                // Hide all the results
                document.querySelectorAll('.glossary__results__row').forEach(row => {
                    row.classList.add('inactive');
                });

                // Loop through the row
                document.querySelectorAll('.glossary__results__row').forEach(row => {
                    const term = row.getAttribute('data-term');

                    if (nav === term) {
                        row.classList.remove('inactive');
                    }
                });

                // Only prevent default if data-toggle is glossary
                if (this.getAttribute('data-toggle') === 'glossary') {
                    e.preventDefault();
                }

            }
        });
    });
}
